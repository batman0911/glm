---
title: "chap_8"
author: "linhnm"
date: '2022-05-15'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

pr 8.4
```{r}
set.seed(10)
y <- rpois(1000, 1)
mean(y)
hist(y)
#y
fit <- glm(y ~ 1, family = poisson(link = "log"))
fit$coefficients

resD <- resid(fit)
resP <- resid(fit, type = "pearson")
resQ <- qresid(fit)

rs1 <- sum(fit$weights * fit$residuals^2)
rs2 <- sum(resP^2)
rs3 <- sum(resD^2)

summary(fit)

# goodness of fit test
1 - pchisq(rs2, df = 0)
pchisq(c(1, 2, 10, 100, 300), df = 10)

#qqnorm(resD)
#qqline(resD)
#title("q-q plot for deviance residual")

#qqnorm(resP)
#qqline(resP)
#title("q-q plot for pearson residual")

#qqnorm(resQ)
#qqline(resQ)
#title("q-q plot for quantile residual")

```

pr 8.10
```{r}
data("seabirds"); str(seabirds)
fit <- glm(Count ~ Quadrat + factor(Species), data = seabirds, family = poisson(link = "log"))
fit

resD <- resid(fit)
resP <- resid(fit, type = "pearson")
f <- fitted(fit)
plot(f, res)

1 - pchisq(c(fit$deviance, sum(resP^2)), df = 1)
```
```{r}
y <- c(15, 26, 4); x <- c(1/4, 1/2, 1/4)
fit <- glm( y ~ 0+x, family=poisson)
summary(fit)
pearson.gof <- sum(fit$weights * fit$residuals^2)
resPearson <- resid(fit, type = "pearson")
1 - pchisq(sum(resPearson^2), df = 2)
1 - pchisq(fit$deviance, df = 2)
```

